# -----------------------------------------------------
# Window rules
# -----------------------------------------------------

# =============================================================================
# Security Dialogs (Pinentry, GPG, Password prompts)
# =============================================================================
# These dialogs should appear above everything (including fullscreen windows),
# be sticky across workspaces, and blur/dim the background for security focus.
#
# Rules explained:
#   float           - Make the dialog floating
#   pin             - Sticky - appears on all workspaces
#   stayfocused     - Keeps focus on dialog, prevents other windows from stealing it
#   dimaround       - Dims and blurs the background (requires blur enabled in decoration.conf)
#   center          - Centers the dialog on screen
#   size            - Sets appropriate dialog size
#   nofullscreenrequest - Prevents dialog from being fullscreened
#
# To test: Run 'gpg --sign testfile' or trigger a password prompt in an app
# When a fullscreen window is active, the pinentry should interrupt and appear on top
#
# gcr-prompter is used by pinentry-gnome3
windowrulev2 = float, class:^(gcr-prompter)$
windowrulev2 = pin, class:^(gcr-prompter)$
windowrulev2 = stayfocused, class:^(gcr-prompter)$
windowrulev2 = dimaround, class:^(gcr-prompter)$
windowrulev2 = center, class:^(gcr-prompter)$
windowrulev2 = size 600 400, class:^(gcr-prompter)$
windowrulev2 = nofullscreenrequest, class:^(gcr-prompter)$

# Pinentry (various implementations)
windowrulev2 = float, class:^(pinentry-.*)$
windowrulev2 = pin, class:^(pinentry-.*)$
windowrulev2 = stayfocused, class:^(pinentry-.*)$
windowrulev2 = dimaround, class:^(pinentry-.*)$
windowrulev2 = center, class:^(pinentry-.*)$
windowrulev2 = size 500 200, class:^(pinentry-.*)$
windowrulev2 = nofullscreenrequest, class:^(pinentry-.*)$

# Alternative pinentry title matching (for any pinentry that doesn't match class)
windowrulev2 = float, title:^(.*PIN.*)$,class:^(gcr-prompter|Pinentry)$
windowrulev2 = pin, title:^(.*PIN.*)$,class:^(gcr-prompter|Pinentry)$
windowrulev2 = stayfocused, title:^(.*PIN.*)$,class:^(gcr-prompter|Pinentry)$
windowrulev2 = dimaround, title:^(.*PIN.*)$,class:^(gcr-prompter|Pinentry)$

# Polkit authentication agent
windowrulev2 = float, class:^(polkit-gnome-authentication-agent-1)$
windowrulev2 = pin, class:^(polkit-gnome-authentication-agent-1)$
windowrulev2 = stayfocused, class:^(polkit-gnome-authentication-agent-1)$
windowrulev2 = dimaround, class:^(polkit-gnome-authentication-agent-1)$
windowrulev2 = center, class:^(polkit-gnome-authentication-agent-1)$
windowrulev2 = nofullscreenrequest, class:^(polkit-gnome-authentication-agent-1)$

# Zenity dialogs (used for keyring and other prompts)
windowrulev2 = float, class:^(zenity)$
windowrulev2 = pin, class:^(zenity)$
windowrulev2 = stayfocused, class:^(zenity)$
windowrulev2 = dimaround, class:^(zenity)$
windowrulev2 = center, class:^(zenity)$
windowrulev2 = nofullscreenrequest, class:^(zenity)$

# Seahorse (GNOME keyring manager) - password/key prompts
windowrulev2 = float, class:^(org.gnome.seahorse.Application)$,title:^(.*[Pp]assword.*)$
windowrulev2 = pin, class:^(org.gnome.seahorse.Application)$,title:^(.*[Pp]assword.*)$
windowrulev2 = stayfocused, class:^(org.gnome.seahorse.Application)$,title:^(.*[Pp]assword.*)$
windowrulev2 = dimaround, class:^(org.gnome.seahorse.Application)$,title:^(.*[Pp]assword.*)$
windowrulev2 = center, class:^(org.gnome.seahorse.Application)$,title:^(.*[Pp]assword.*)$
windowrulev2 = size 500 300, class:^(org.gnome.seahorse.Application)$,title:^(.*[Pp]assword.*)$

# Workspace assignments
windowrulev2 = workspace 1, class:^(firefox)$
windowrulev2 = workspace 2, class:^(chromium-browser)$
windowrulev2 = workspace 2, class:^(Chromium)$
windowrulev2 = workspace 3, class:^(kitty)$

# Chat applications on workspace 1
windowrulev2 = workspace 1, class:^(org.telegram.desktop)$
windowrulev2 = workspace 1, class:^(telegram-desktop)$
windowrulev2 = workspace 1, class:^(TelegramDesktop)$
windowrulev2 = workspace 1, class:^(Signal)$
windowrulev2 = workspace 1, class:^(signal)$
windowrulev2 = workspace 1, class:^(Element)$
windowrulev2 = workspace 1, class:^(element)$
windowrulev2 = workspace 1, class:^(io.element.Element)$
windowrulev2 = workspace 1, class:^(FluffyChat)$
windowrulev2 = workspace 1, class:^(im.fluffychat.Fluffychat)$
windowrulev2 = workspace 1, class:^(Nheko)$
windowrulev2 = workspace 1, class:^(io.github.NhekoReborn.Nheko)$

windowrule = float, title:^(pavucontrol)$
windowrule = float, title:^(blueman-manager)$
windowrule = float, title:^(nm-connection-editor)$
windowrule = float, title:^(qalculate-gtk)$

# Browser Picture in Picture
windowrule = float, title:^(Picture-in-Picture)$
windowrule = pin, title:^(Picture-in-Picture)$
windowrule = move 69.5% 4%, title:^(Picture-in-Picture)$

# idleinhibit
windowrule = idleinhibit fullscreen,class:([window]) # Available modes: none, always, focus, fullscreen

#xwayland related rules
# when moving objects in resolve a large border is produced 
# This rule prevents that and serves as a template for any problematic xwayland apps
windowrule = noblur, class:^(\bresolve\b)$, xwayland:1
# This is a general rule for xwayland apps but can have other consequences 
# for one user it impacted EMACs so it's disabled by default 
# It's here as a reference or for quick triage of xwayland ap
#windowrule = noblur, xwayland:1

