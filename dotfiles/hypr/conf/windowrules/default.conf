# -----------------------------------------------------
# Window rules
# -----------------------------------------------------

# =============================================================================
# Security Dialogs (Pinentry, GPG, Password prompts)
# =============================================================================
# These dialogs should appear above everything (including fullscreen windows),
# be sticky across workspaces, and blur/dim the background for security focus.
#
# Rules explained:
#   float           - Make the dialog floating
#   pin             - Sticky - appears on all workspaces
#   stayfocused     - Keeps focus on dialog, prevents other windows from stealing it
#   dimaround       - Dims and blurs the background (requires blur enabled in decoration.conf)
#   center          - Centers the dialog on screen
#   size            - Sets appropriate dialog size
#   nofullscreenrequest - Prevents dialog from being fullscreened
#
# To test: Run 'gpg --sign testfile' or trigger a password prompt in an app
# When a fullscreen window is active, the pinentry should interrupt and appear on top
#
# gcr-prompter is used by pinentry-gnome3
windowrule = float 1, class:^(gcr-prompter)$
windowrule = pin 1, class:^(gcr-prompter)$
windowrule = stayfocused 1, class:^(gcr-prompter)$
windowrule = dimaround 1, class:^(gcr-prompter)$
windowrule = center 1, class:^(gcr-prompter)$
windowrule = size 600 400, class:^(gcr-prompter)$
#windowrule = nofullscreenrequest, class:^(gcr-prompter)$

# Pinentry (various implementations)
windowrule = float 1, class:^(pinentry-.*)$
windowrule = pin 1, class:^(pinentry-.*)$
windowrule = stayfocused 1, class:^(pinentry-.*)$
windowrule = dimaround 1, class:^(pinentry-.*)$
windowrule = center 1, class:^(pinentry-.*)$
windowrule = size 500 200, class:^(pinentry-.*)$
#windowrule = nofullscreenrequest, class:^(pinentry-.*)$

# Alternative pinentry title matching (for any pinentry that doesn't match class)
windowrule = float 1, title:^(.*PIN.*)$,class:^(gcr-prompter|Pinentry)$
windowrule = pin 1, title:^(.*PIN.*)$,class:^(gcr-prompter|Pinentry)$
windowrule = stayfocused 1, title:^(.*PIN.*)$,class:^(gcr-prompter|Pinentry)$
windowrule = dimaround 1, title:^(.*PIN.*)$,class:^(gcr-prompter|Pinentry)$

# Polkit authentication agent
windowrule = float 1, class:^(polkit-gnome-authentication-agent-1)$
windowrule = pin 1, class:^(polkit-gnome-authentication-agent-1)$
windowrule = stayfocused 1, class:^(polkit-gnome-authentication-agent-1)$
windowrule = dimaround 1, class:^(polkit-gnome-authentication-agent-1)$
windowrule = center 1, class:^(polkit-gnome-authentication-agent-1)$
#windowrule = nofullscreenrequest, class:^(polkit-gnome-authentication-agent-1)$

# Zenity dialogs (used for keyring and other prompts)
windowrule = float 1, class:^(zenity)$
windowrule = pin 1, class:^(zenity)$
windowrule = stayfocused 1, class:^(zenity)$
windowrule = dimaround 1, class:^(zenity)$
windowrule = center 1, class:^(zenity)$
#windowrule = nofullscreenrequest, class:^(zenity)$

# Seahorse (GNOME keyring manager) - password/key prompts
windowrule = float 1, class:^(org.gnome.seahorse.Application)$,title:^(.*[Pp]assword.*)$
windowrule = pin 1, class:^(org.gnome.seahorse.Application)$,title:^(.*[Pp]assword.*)$
windowrule = stayfocused 1, class:^(org.gnome.seahorse.Application)$,title:^(.*[Pp]assword.*)$
windowrule = dimaround 1, class:^(org.gnome.seahorse.Application)$,title:^(.*[Pp]assword.*)$
windowrule = center 1, class:^(org.gnome.seahorse.Application)$,title:^(.*[Pp]assword.*)$
windowrule = size 500 300, class:^(org.gnome.seahorse.Application)$,title:^(.*[Pp]assword.*)$

# Workspace assignments
windowrule = workspace 1, class:^(firefox)$
windowrule = workspace 3, class:^(kitty)$

# Chat applications and Chromium on scratchpad
windowrule = workspace special:scratchpad, class:^(chromium-browser)$
windowrule = workspace special:scratchpad, class:^(Chromium)$
windowrule = workspace special:scratchpad, class:^(org.telegram.desktop)$
windowrule = workspace special:scratchpad, class:^(telegram-desktop)$
windowrule = workspace special:scratchpad, class:^(TelegramDesktop)$
windowrule = workspace special:scratchpad, class:^(Signal)$
windowrule = workspace special:scratchpad, class:^(signal)$
windowrule = workspace special:scratchpad, class:^(Element)$
windowrule = workspace special:scratchpad, class:^(element)$
windowrule = workspace special:scratchpad, class:^(io.element.Element)$
windowrule = workspace special:scratchpad, class:^(FluffyChat)$
windowrule = workspace special:scratchpad, class:^(im.fluffychat.Fluffychat)$
windowrule = workspace special:scratchpad, class:^(Nheko)$
windowrule = workspace special:scratchpad, class:^(io.github.NhekoReborn.Nheko)$
windowrule = workspace special:scratchpad, class:^(whatsapp)$
windowrule = workspace special:scratchpad, class:^(WhatsApp)$
windowrule = workspace special:scratchpad, class:^(whatsapp-for-linux)$
windowrule = workspace special:scratchpad, class:^(ZapZap)$
windowrule = workspace special:scratchpad, class:^(com.rtosta.zapzap)$

windowrule = float 1, title:^(pavucontrol)$
windowrule = float 1, title:^(blueman-manager)$
windowrule = float 1, title:^(nm-connection-editor)$
windowrule = float 1, title:^(qalculate-gtk)$

# Browser Picture in Picture
windowrule = float 1, title:^(Picture-in-Picture)$
windowrule = pin 1, title:^(Picture-in-Picture)$
windowrule = move 69.5% 4%, title:^(Picture-in-Picture)$

# idleinhibit
windowrule = idleinhibit fullscreen,class:([window]) # Available modes: none, always, focus, fullscreen

#xwayland related rules
# when moving objects in resolve a large border is produced 
# This rule prevents that and serves as a template for any problematic xwayland apps
windowrule = noblur, class:^(\bresolve\b)$, xwayland:1
# This is a general rule for xwayland apps but can have other consequences 
# for one user it impacted EMACs so it's disabled by default 
# It's here as a reference or for quick triage of xwayland ap
#windowrule = noblur, xwayland:1

