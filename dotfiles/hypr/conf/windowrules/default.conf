# -----------------------------------------------------
# Window rules (Hyprland 0.53+ syntax)
# -----------------------------------------------------

# =============================================================================
# Security Dialogs (Pinentry, GPG, Password prompts)
# =============================================================================
# These dialogs should appear above everything (including fullscreen windows),
# be sticky across workspaces, and blur/dim the background for security focus.
#
# Rules explained:
#   float on        - Make the dialog floating
#   pin on          - Sticky - appears on all workspaces
#   stay_focused on - Keeps focus on dialog, prevents other windows from stealing it
#   dim_around on   - Dims and blurs the background (requires blur enabled in decoration.conf)
#   center on       - Centers the dialog on screen
#   size            - Sets appropriate dialog size
#
# To test: Run 'gpg --sign testfile' or trigger a password prompt in an app
# When a fullscreen window is active, the pinentry should interrupt and appear on top
#
# gcr-prompter is used by pinentry-gnome3
windowrule = float on, match:class ^(gcr-prompter)$
windowrule = pin on, match:class ^(gcr-prompter)$
windowrule = stay_focused on, match:class ^(gcr-prompter)$
windowrule = dim_around on, match:class ^(gcr-prompter)$
windowrule = center on, match:class ^(gcr-prompter)$
windowrule = size 600 400, match:class ^(gcr-prompter)$

# Pinentry (various implementations)
windowrule = float on, match:class ^(pinentry-.*)$
windowrule = pin on, match:class ^(pinentry-.*)$
windowrule = stay_focused on, match:class ^(pinentry-.*)$
windowrule = dim_around on, match:class ^(pinentry-.*)$
windowrule = center on, match:class ^(pinentry-.*)$
windowrule = size 500 200, match:class ^(pinentry-.*)$

# Alternative pinentry title matching (for any pinentry that doesn't match class)
windowrule = float on, match:class ^(gcr-prompter|Pinentry)$, match:title ^(.*PIN.*)$
windowrule = pin on, match:class ^(gcr-prompter|Pinentry)$, match:title ^(.*PIN.*)$
windowrule = stay_focused on, match:class ^(gcr-prompter|Pinentry)$, match:title ^(.*PIN.*)$
windowrule = dim_around on, match:class ^(gcr-prompter|Pinentry)$, match:title ^(.*PIN.*)$

# Polkit authentication agent
windowrule = float on, match:class ^(polkit-gnome-authentication-agent-1)$
windowrule = pin on, match:class ^(polkit-gnome-authentication-agent-1)$
windowrule = stay_focused on, match:class ^(polkit-gnome-authentication-agent-1)$
windowrule = dim_around on, match:class ^(polkit-gnome-authentication-agent-1)$
windowrule = center on, match:class ^(polkit-gnome-authentication-agent-1)$

# Zenity dialogs (used for keyring and other prompts)
windowrule = float on, match:class ^(zenity)$
windowrule = pin on, match:class ^(zenity)$
windowrule = stay_focused on, match:class ^(zenity)$
windowrule = dim_around on, match:class ^(zenity)$
windowrule = center on, match:class ^(zenity)$

# Seahorse (GNOME keyring manager) - password/key prompts
windowrule = float on, match:class ^(org.gnome.seahorse.Application)$, match:title ^(.*[Pp]assword.*)$
windowrule = pin on, match:class ^(org.gnome.seahorse.Application)$, match:title ^(.*[Pp]assword.*)$
windowrule = stay_focused on, match:class ^(org.gnome.seahorse.Application)$, match:title ^(.*[Pp]assword.*)$
windowrule = dim_around on, match:class ^(org.gnome.seahorse.Application)$, match:title ^(.*[Pp]assword.*)$
windowrule = center on, match:class ^(org.gnome.seahorse.Application)$, match:title ^(.*[Pp]assword.*)$
windowrule = size 500 300, match:class ^(org.gnome.seahorse.Application)$, match:title ^(.*[Pp]assword.*)$

windowrule = float on, match:title ^(pavucontrol)$
windowrule = float on, match:title ^(blueman-manager)$
windowrule = float on, match:title ^(nm-connection-editor)$
windowrule = float on, match:title ^(qalculate-gtk)$

# Browser Picture in Picture
windowrule = float on, match:title ^(Picture-in-Picture)$
windowrule = pin on, match:title ^(Picture-in-Picture)$
windowrule = move 69.5% 4%, match:title ^(Picture-in-Picture)$

# idle_inhibit - inhibit idle when any window is fullscreen
windowrule = idle_inhibit fullscreen, match:fullscreen 1

# xwayland related rules
# when moving objects in resolve a large border is produced
# This rule prevents that and serves as a template for any problematic xwayland apps
windowrule = no_blur on, match:class ^(\bresolve\b)$, match:xwayland 1
# This is a general rule for xwayland apps but can have other consequences
# for one user it impacted EMACs so it's disabled by default
# It's here as a reference or for quick triage of xwayland apps
#windowrule = no_blur on, match:xwayland 1

# =============================================================================
# Privacy - Hide sensitive windows from screensharing (Hyprland 0.50+)
# =============================================================================
# These windows will appear blacked out when screen sharing

# Password managers
windowrule = no_screen_share on, match:class ^(1Password)$
windowrule = no_screen_share on, match:class ^(Bitwarden)$
windowrule = no_screen_share on, match:class ^(KeePassXC)$
windowrule = no_screen_share on, match:class ^(org.gnome.seahorse.Application)$

# Terminal windows (may contain sensitive data)
# Uncomment if you want terminals hidden during screenshare
#windowrule = no_screen_share on, match:class ^(kitty)$
#windowrule = no_screen_share on, match:class ^(Alacritty)$

# =============================================================================
# VRR Control (Hyprland 0.51+)
# =============================================================================
# Disable variable refresh rate for apps that don't handle it well

# Video players - VRR can cause stutter with fixed framerate content
windowrule = novrr on, match:class ^(mpv)$
windowrule = novrr on, match:class ^(vlc)$

# =============================================================================
# Eye Candy - Animation overrides for specific windows
# =============================================================================

# Floating utilities - quicker animations
windowrule = animation popin 80%, match:floating 1
